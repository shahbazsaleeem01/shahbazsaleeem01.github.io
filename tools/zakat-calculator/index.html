<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zakat Calculator ‚Äî Shahbaz Saleem Tools</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:        #0d1117;
      --surface:   #161b22;
      --surface2:  #1c2128;
      --border:    #30363d;
      --text:      #e6edf3;
      --muted:     #8b949e;
      --accent:    #58a6ff;
      --green:     #3fb950;
      --green-dim: #1a3a24;
      --gold:      #d29922;
      --gold-dim:  #2d2208;
      --red:       #f85149;
    }

    html { scroll-behavior: smooth; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* NAV */
    nav {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      height: 60px;
      background: rgba(13, 17, 23, 0.85);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border);
    }

    .nav-logo {
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--text);
      text-decoration: none;
      letter-spacing: 0.02em;
    }

    .nav-links {
      display: flex;
      gap: 2rem;
      list-style: none;
    }

    .nav-links a {
      color: var(--muted);
      text-decoration: none;
      font-size: 0.9rem;
      transition: color 0.2s;
    }

    .nav-links a:hover,
    .nav-links a.active { color: var(--accent); }

    /* BREADCRUMB */
    .breadcrumb {
      max-width: 860px;
      margin: 0 auto;
      padding: 1.25rem 2rem 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .breadcrumb a { color: var(--muted); text-decoration: none; }
    .breadcrumb a:hover { color: var(--accent); }
    .breadcrumb span { color: var(--text); }

    /* MAIN */
    main {
      flex: 1;
      max-width: 860px;
      width: 100%;
      margin: 0 auto;
      padding: 2.5rem 2rem 6rem;
    }

    .page-label {
      font-size: 0.85rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 0.6rem;
    }

    .page-title {
      font-size: clamp(1.8rem, 4vw, 2.75rem);
      font-weight: 800;
      line-height: 1.15;
      margin-bottom: 0.6rem;
    }

    .page-subtitle {
      color: var(--muted);
      font-size: 0.95rem;
      max-width: 580px;
      margin-bottom: 2.5rem;
    }

    .section-divider {
      width: 48px;
      height: 3px;
      background: var(--accent);
      border-radius: 2px;
      margin-bottom: 2rem;
    }

    /* LAYOUT */
    .calculator-layout {
      display: grid;
      grid-template-columns: 1fr 340px;
      gap: 1.5rem;
      align-items: start;
    }

    /* NISAB SELECTOR */
    .nisab-selector {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .nisab-selector h2 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .nisab-selector p {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 1rem;
    }

    .nisab-tabs {
      display: flex;
      gap: 0.5rem;
    }

    .nisab-tab {
      flex: 1;
      padding: 0.6rem 1rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: transparent;
      color: var(--muted);
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    .nisab-tab:hover { border-color: var(--accent); color: var(--text); }

    .nisab-tab.active {
      background: var(--accent-dim, #1f6feb);
      border-color: var(--accent);
      color: var(--text);
      font-weight: 600;
    }

    .nisab-info {
      margin-top: 0.75rem;
      padding: 0.75rem 1rem;
      background: var(--surface2);
      border-radius: 8px;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .nisab-info strong { color: var(--text); }

    /* CURRENCY SELECTOR */
    .currency-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 0.6rem;
    }

    .currency-row label {
      font-size: 0.9rem;
      font-weight: 600;
      white-space: nowrap;
    }

    select {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-size: 0.875rem;
      padding: 0.5rem 0.75rem;
      cursor: pointer;
      outline: none;
      transition: border-color 0.2s;
    }

    select:focus { border-color: var(--accent); }

    /* ASSET SECTIONS */
    .asset-section {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.25rem;
    }

    .asset-section-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.25rem;
    }

    .asset-section-icon {
      font-size: 1.4rem;
      line-height: 1;
    }

    .asset-section-title {
      font-size: 1rem;
      font-weight: 700;
    }

    .asset-section-subtitle {
      font-size: 0.78rem;
      color: var(--muted);
    }

    /* FIELD */
    .field {
      margin-bottom: 1rem;
    }

    .field:last-child { margin-bottom: 0; }

    .field label {
      display: block;
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--muted);
      margin-bottom: 0.4rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .input-wrapper {
      display: flex;
      align-items: center;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      transition: border-color 0.2s;
    }

    .input-wrapper:focus-within { border-color: var(--accent); }

    .input-prefix {
      padding: 0.55rem 0.75rem;
      background: var(--surface);
      border-right: 1px solid var(--border);
      font-size: 0.85rem;
      color: var(--muted);
      white-space: nowrap;
    }

    .input-wrapper input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      color: var(--text);
      font-size: 0.95rem;
      padding: 0.55rem 0.75rem;
      min-width: 0;
    }

    .input-wrapper input::placeholder { color: var(--muted); opacity: 0.5; }

    .field-hint {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 0.3rem;
    }

    /* PRICE STATUS BADGE */
    .price-status {
      display: inline-flex;
      align-items: center;
      margin-bottom: 0.6rem;
      gap: 0.4rem;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.3rem 0.7rem;
      border-radius: 20px;
      white-space: nowrap;
    }

    /* API DEBUG PANEL */
    #api-debug {
      margin-bottom: 1.5rem;
      font-size: 0.78rem;
    }
    #api-debug summary {
      cursor: pointer;
      color: var(--muted);
      padding: 0.3rem 0;
      user-select: none;
      font-size: 0.78rem;
    }
    #api-debug table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.5rem;
      font-family: monospace;
    }
    #api-debug th, #api-debug td {
      padding: 0.3rem 0.6rem;
      text-align: left;
      border: 1px solid var(--border);
      vertical-align: top;
    }
    #api-debug th {
      color: var(--muted);
      font-weight: 600;
      background: var(--surface2);
      font-size: 0.72rem;
    }
    #api-debug td:first-child { white-space: nowrap; color: var(--muted); }
    #api-debug .ok  { color: var(--green); }
    #api-debug .err { color: var(--red);   }

    .price-status--loading {
      background: var(--surface2);
      color: var(--muted);
      border: 1px solid var(--border);
    }

    .price-status--live {
      background: #1a3a24;
      color: var(--green);
      border: 1px solid var(--green);
    }

    .price-status--fallback {
      background: var(--gold-dim);
      color: var(--gold);
      border: 1px solid var(--gold);
    }

    .price-status--partial {
      background: #2d2208;
      color: var(--gold);
      border: 1px solid var(--gold);
    }

    .price-status--error {
      background: #3d1a1a;
      color: var(--red);
      border: 1px solid var(--red);
    }

    @keyframes spin { to { transform: rotate(360deg); } }
    .spin { animation: spin 1s linear infinite; }

    /* LIVE PRICE DISPLAY (read-only) */
    .live-price-display {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text);
      font-variant-numeric: tabular-nums;
    }

    /* METAL FIELD (gold / silver weight + unit toggle + price) */
    .metal-block { margin-bottom: 1.25rem; }
    .metal-block:last-child { margin-bottom: 0; }

    .metal-block-title {
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--text);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin-bottom: 0.6rem;
    }

    .metal-weight-row {
      display: flex;
      gap: 0.5rem;
      align-items: stretch;
      margin-bottom: 0.5rem;
    }

    .metal-weight-row .input-wrapper { flex: 1; }

    .unit-toggle {
      display: flex;
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      flex-shrink: 0;
    }

    .unit-btn {
      padding: 0.55rem 0.85rem;
      background: var(--surface2);
      border: none;
      color: var(--muted);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, color 0.15s;
      border-right: 1px solid var(--border);
      white-space: nowrap;
    }

    .unit-btn:last-child { border-right: none; }
    .unit-btn:hover { color: var(--text); }

    .unit-btn.active {
      background: var(--accent-dim, #1f6feb);
      color: var(--text);
      font-weight: 600;
    }

    .price-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .price-row label {
      font-size: 0.75rem;
      color: var(--muted);
      white-space: nowrap;
      min-width: 110px;
      text-transform: none;
      letter-spacing: 0;
      font-weight: 500;
    }

    .price-row .input-wrapper { flex: 1; }

    .metal-separator {
      border: none;
      border-top: 1px solid var(--border);
      margin: 1rem 0;
    }

    /* RESULT PANEL */
    .result-panel {
      position: sticky;
      top: 80px;
    }

    .result-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }

    .result-card-header {
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid var(--border);
    }

    .result-card-header h2 {
      font-size: 0.95rem;
      font-weight: 700;
    }

    .result-card-header p {
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 0.2rem;
    }

    .result-body { padding: 1.5rem; }

    .result-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      padding: 0.5rem 0;
      font-size: 0.875rem;
      border-bottom: 1px solid var(--border);
    }

    .result-row:last-of-type { border-bottom: none; }

    .result-row .label { color: var(--muted); }
    .result-row .value { font-weight: 600; font-variant-numeric: tabular-nums; }

    .result-nisab-status {
      margin: 1rem 0;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      font-size: 0.82rem;
      font-weight: 600;
    }

    .result-nisab-status.above {
      background: var(--green-dim);
      color: var(--green);
      border: 1px solid var(--green);
    }

    .result-nisab-status.below {
      background: var(--gold-dim);
      color: var(--gold);
      border: 1px solid var(--gold);
    }

    .result-zakat {
      text-align: center;
      padding: 1.25rem;
      background: var(--surface2);
      border-radius: 10px;
      margin-top: 1rem;
    }

    .result-zakat-label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--muted);
      margin-bottom: 0.4rem;
    }

    .result-zakat-amount {
      font-size: 2rem;
      font-weight: 800;
      color: var(--green);
      font-variant-numeric: tabular-nums;
    }

    .result-zakat-rate {
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 0.3rem;
    }

    .result-zakat-zero {
      font-size: 0.875rem;
      color: var(--muted);
      margin-top: 0.5rem;
    }

    /* DISCLAIMER */
    .disclaimer {
      background: var(--surface);
      border: 1px solid var(--border);
      border-left: 3px solid var(--gold);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      font-size: 0.78rem;
      color: var(--muted);
      margin-top: 1.25rem;
      line-height: 1.6;
    }

    .disclaimer strong { color: var(--gold); }

    /* INFO BOX */
    .info-box {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 1.5rem;
    }

    .info-box h3 {
      font-size: 0.95rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--text);
    }

    .info-box p {
      font-size: 0.82rem;
      color: var(--muted);
      margin-bottom: 0.75rem;
      line-height: 1.6;
    }

    .info-box p:last-child { margin-bottom: 0; }

    /* FOOTER */
    footer {
      text-align: center;
      padding: 2rem;
      border-top: 1px solid var(--border);
      color: var(--muted);
      font-size: 0.85rem;
    }

    footer a { color: var(--accent); text-decoration: none; }
    footer a:hover { text-decoration: underline; }

    @media (max-width: 720px) {
      .calculator-layout { grid-template-columns: 1fr; }
      .result-panel { position: static; }
      .nav-links { gap: 1.2rem; }
    }

    @media (max-width: 480px) {
      .nav-links { gap: 0.9rem; font-size: 0.8rem; }
    }
  </style>
</head>
<body>

  <!-- NAV -->
  <nav>
    <a href="../../" class="nav-logo">SS</a>
    <ul class="nav-links">
      <li><a href="../../#about">About</a></li>
      <li><a href="../../#contact">Contact</a></li>
      <li><a href="../" class="active">Tools</a></li>
    </ul>
  </nav>

  <!-- BREADCRUMB -->
  <div class="breadcrumb">
    <a href="../../">Home</a>
    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
    <a href="../">Tools</a>
    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
    <span>Zakat Calculator</span>
  </div>

  <!-- MAIN -->
  <main>
    <p class="page-label">Islamic Finance Tool</p>
    <h1 class="page-title">üåô Zakat Calculator</h1>
    <p class="page-subtitle">
      Enter your zakatable assets below. All calculations happen in your browser ‚Äî nothing is stored or sent anywhere.
    </p>
    <div class="section-divider"></div>

    <!-- CURRENCY + PRICE STATUS -->
    <div class="currency-row">
      <label for="currency-select">Currency:</label>
      <select id="currency-select">
        <option value="PKR" data-symbol="Rs"  data-default-unit="tola">Pakistani Rupee (PKR)</option>
        <option value="USD" data-symbol="$"   data-default-unit="gram">US Dollar (USD)</option>
        <option value="GBP" data-symbol="¬£"   data-default-unit="gram">British Pound (GBP)</option>
        <option value="EUR" data-symbol="‚Ç¨"   data-default-unit="gram">Euro (EUR)</option>
        <option value="AED" data-symbol="AED" data-default-unit="tola">UAE Dirham (AED)</option>
        <option value="SAR" data-symbol="SAR" data-default-unit="tola">Saudi Riyal (SAR)</option>
        <option value="CAD" data-symbol="CA$" data-default-unit="gram">Canadian Dollar (CAD)</option>
        <option value="AUD" data-symbol="A$"  data-default-unit="gram">Australian Dollar (AUD)</option>
      </select>
    </div>
    <div id="price-status" class="price-status price-status--loading">
      <svg class="spin" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>
      Fetching live prices‚Ä¶
    </div>

    <details id="api-debug" open>
      <summary>‚ñ∏ API debug log</summary>
      <div id="api-debug-body">
        <table>
          <thead><tr><th>Source</th><th>Result</th><th>Detail</th></tr></thead>
          <tbody id="api-debug-rows"><tr><td colspan="3" style="color:var(--muted)">Waiting‚Ä¶</td></tr></tbody>
        </table>
      </div>
    </details>

    <!-- NISAB -->
    <div class="nisab-selector">
      <h2>Nisab Standard</h2>
      <p>Choose which standard to use to determine your Nisab threshold.</p>
      <div class="nisab-tabs">
        <button class="nisab-tab" data-type="silver">Silver Standard <br><small>612.36g ¬∑ 52.5 tola</small></button>
        <button class="nisab-tab active" data-type="gold">Gold Standard <br><small>87.48g ¬∑ 7.5 tola</small></button>
      </div>
      <div class="nisab-info" id="nisab-info">
        Nisab: <strong id="nisab-display">‚Äî</strong>
      </div>
    </div>

    <!-- CALCULATOR LAYOUT -->
    <div class="calculator-layout">
      <!-- LEFT: INPUTS -->
      <div class="inputs-col">

        <!-- CASH & SAVINGS -->
        <div class="asset-section">
          <div class="asset-section-header">
            <span class="asset-section-icon">üíµ</span>
            <div>
              <div class="asset-section-title">Cash &amp; Savings</div>
              <div class="asset-section-subtitle">Bank accounts, cash at home, digital wallets</div>
            </div>
          </div>
          <div class="field">
            <label for="cash">Cash at hand / bank savings</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-cash">Rs</span>
              <input type="number" id="cash" placeholder="0" min="0" step="any" />
            </div>
          </div>
          <div class="field">
            <label for="receivables">Money owed to you (receivables)</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-receivables">Rs</span>
              <input type="number" id="receivables" placeholder="0" min="0" step="any" />
            </div>
            <p class="field-hint">Only include amounts you expect to recover.</p>
          </div>
        </div>

        <!-- GOLD & SILVER -->
        <div class="asset-section">
          <div class="asset-section-header">
            <span class="asset-section-icon">ü•á</span>
            <div>
              <div class="asset-section-title">Gold &amp; Silver</div>
              <div class="asset-section-subtitle">Jewellery, bars, coins</div>
            </div>
          </div>

          <!-- GOLD -->
          <div class="metal-block">
            <div class="metal-block-title">Gold</div>
            <div class="metal-weight-row">
              <div class="input-wrapper">
                <span class="input-prefix" id="gold-unit-label">tola</span>
                <input type="number" id="gold-weight" placeholder="0" min="0" step="any" />
              </div>
              <div class="unit-toggle">
                <button class="unit-btn" data-metal="gold" data-unit="gram">gram</button>
                <button class="unit-btn active" data-metal="gold" data-unit="tola">tola</button>
              </div>
            </div>
            <div class="price-row">
              <label id="gold-price-label">Live price / tola</label>
              <span class="live-price-display" id="gold-price-display">‚Äî</span>
            </div>
          </div>

          <hr class="metal-separator" />

          <!-- SILVER -->
          <div class="metal-block">
            <div class="metal-block-title">Silver</div>
            <div class="metal-weight-row">
              <div class="input-wrapper">
                <span class="input-prefix" id="silver-unit-label">tola</span>
                <input type="number" id="silver-weight" placeholder="0" min="0" step="any" />
              </div>
              <div class="unit-toggle">
                <button class="unit-btn" data-metal="silver" data-unit="gram">gram</button>
                <button class="unit-btn active" data-metal="silver" data-unit="tola">tola</button>
              </div>
            </div>
            <div class="price-row">
              <label id="silver-price-label">Live price / tola</label>
              <span class="live-price-display" id="silver-price-display">‚Äî</span>
            </div>
          </div>

        </div>

        <!-- INVESTMENTS -->
        <div class="asset-section">
          <div class="asset-section-header">
            <span class="asset-section-icon">üìà</span>
            <div>
              <div class="asset-section-title">Investments</div>
              <div class="asset-section-subtitle">Stocks, mutual funds, crypto, retirement accounts</div>
            </div>
          </div>
          <div class="field">
            <label for="stocks">Stocks &amp; shares (current market value)</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-stocks">Rs</span>
              <input type="number" id="stocks" placeholder="0" min="0" step="any" />
            </div>
          </div>
          <div class="field">
            <label for="crypto">Cryptocurrency (current value)</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-crypto">Rs</span>
              <input type="number" id="crypto" placeholder="0" min="0" step="any" />
            </div>
          </div>
          <div class="field">
            <label for="other-investments">Other investments</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-other-investments">Rs</span>
              <input type="number" id="other-investments" placeholder="0" min="0" step="any" />
            </div>
          </div>
        </div>

        <!-- BUSINESS -->
        <div class="asset-section">
          <div class="asset-section-header">
            <span class="asset-section-icon">üè¢</span>
            <div>
              <div class="asset-section-title">Business Assets</div>
              <div class="asset-section-subtitle">Stock in trade and liquid business assets</div>
            </div>
          </div>
          <div class="field">
            <label for="business-inventory">Business inventory / stock in trade</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-business-inventory">Rs</span>
              <input type="number" id="business-inventory" placeholder="0" min="0" step="any" />
            </div>
            <p class="field-hint">Fixed assets (machinery, buildings) are generally not zakatable.</p>
          </div>
          <div class="field">
            <label for="business-cash">Business cash &amp; receivables</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-business-cash">Rs</span>
              <input type="number" id="business-cash" placeholder="0" min="0" step="any" />
            </div>
          </div>
        </div>

        <!-- LIABILITIES -->
        <div class="asset-section" style="border-color: var(--red);">
          <div class="asset-section-header">
            <span class="asset-section-icon">üìâ</span>
            <div>
              <div class="asset-section-title">Liabilities (Deductions)</div>
              <div class="asset-section-subtitle">Debts and dues payable within the year</div>
            </div>
          </div>
          <div class="field">
            <label for="debts">Short-term debts &amp; loans due</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-debts">Rs</span>
              <input type="number" id="debts" placeholder="0" min="0" step="any" />
            </div>
          </div>
          <div class="field">
            <label for="other-liabilities">Other liabilities due within the year</label>
            <div class="input-wrapper">
              <span class="input-prefix" id="prefix-other-liabilities">Rs</span>
              <input type="number" id="other-liabilities" placeholder="0" min="0" step="any" />
            </div>
          </div>
        </div>

        <!-- INFO -->
        <div class="info-box">
          <h3>How Zakat is calculated</h3>
          <p>Zakat is 2.5% of your total zakatable wealth, provided your net wealth has remained above the Nisab threshold for one full Islamic lunar year (Hawl).</p>
          <p><strong>Nisab</strong> is the minimum wealth threshold before Zakat is due. It equals 87.48g (7.5 tola) of gold or 612.36g (52.5 tola) of silver. Gold and silver prices are fetched live from international spot markets.</p>
          <p>Most scholars recommend using the silver Nisab as it is lower and ensures more people are included. However, using the gold Nisab is also valid.</p>
          <p>Personal items such as your home, car, clothing, and furniture are generally not zakatable.</p>
        </div>

      </div>

      <!-- RIGHT: RESULT PANEL -->
      <div class="result-panel">
        <div class="result-card">
          <div class="result-card-header">
            <h2>Your Zakat Summary</h2>
            <p>Updates in real time as you type</p>
          </div>
          <div class="result-body">

            <div class="result-row">
              <span class="label">Total assets</span>
              <span class="value" id="res-total-assets">‚Äî</span>
            </div>
            <div class="result-row">
              <span class="label">Total liabilities</span>
              <span class="value" id="res-total-liabilities" style="color:var(--red)">‚Äî</span>
            </div>
            <div class="result-row">
              <span class="label">Net zakatable wealth</span>
              <span class="value" id="res-net-wealth">‚Äî</span>
            </div>
            <div class="result-row">
              <span class="label">Nisab threshold</span>
              <span class="value" id="res-nisab">‚Äî</span>
            </div>

            <div class="result-nisab-status" id="nisab-status" style="display:none"></div>

            <div class="result-zakat" id="zakat-result-box">
              <div class="result-zakat-label">Zakat Due (2.5%)</div>
              <div class="result-zakat-amount" id="res-zakat-amount">‚Äî</div>
              <div class="result-zakat-rate" id="res-zakat-note"></div>
            </div>

          </div>
        </div>

        <div class="disclaimer">
          <strong>Disclaimer:</strong> This calculator provides an estimate for educational purposes only. Gold and silver prices are approximate reference values and may differ from actual market rates. Please verify current spot prices and consult a qualified Islamic scholar or financial advisor for your specific situation.
        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer>
    <p>&copy; <span id="year"></span> <a href="../../">Shahbaz Saleem</a> ¬∑ <a href="../">All Tools</a></p>
  </footer>

  <script>
    // ‚îÄ‚îÄ Constants ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const TROY_OZ_TO_GRAMS = 31.1035;
    const TOLA_IN_GRAMS    = 11.664;
    const GOLD_GRAMS_NISAB   = 87.48;   // = 7.5 tola
    const SILVER_GRAMS_NISAB = 612.36;  // = 52.5 tola

    // Fallback prices per gram in USD (used if API fails)
    const FALLBACK_GOLD_USD_PER_GRAM   = 2900 / TROY_OZ_TO_GRAMS; // ~$93/g
    const FALLBACK_SILVER_USD_PER_GRAM = 32   / TROY_OZ_TO_GRAMS; // ~$1.03/g

    // Fallback exchange rates vs USD
    const FALLBACK_RATES = {
      USD: 1, PKR: 278, GBP: 0.79, EUR: 0.92,
      AED: 3.67, SAR: 3.75, CAD: 1.43, AUD: 1.60
    };

    // ‚îÄ‚îÄ State ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let nisabType  = 'gold';  // 'gold' | 'silver'
    let currencyKey = 'PKR';
    let goldUnit   = 'tola';  // 'gram' | 'tola'
    let silverUnit = 'tola';

    // Prices per gram in USD (populated from API or fallback)
    let goldPriceUSD   = null;
    let silverPriceUSD = null;
    let liveRates      = null; // exchange rates keyed by currency code

    // Currency metadata from select options
    const currencyMeta = {};
    document.querySelectorAll('#currency-select option').forEach(opt => {
      currencyMeta[opt.value] = {
        symbol:      opt.dataset.symbol,
        defaultUnit: opt.dataset.defaultUnit || 'gram',
      };
    });

    // ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function sym() { return currencyMeta[currencyKey].symbol; }

    function rate() {
      const r = liveRates || FALLBACK_RATES;
      return r[currencyKey] || 1;
    }

    function goldPerGramLocal()   { return (goldPriceUSD   || FALLBACK_GOLD_USD_PER_GRAM)   * rate(); }
    function silverPerGramLocal() { return (silverPriceUSD || FALLBACK_SILVER_USD_PER_GRAM) * rate(); }

    function toGrams(weight, unit) {
      return unit === 'tola' ? weight * TOLA_IN_GRAMS : weight;
    }

    function fmt(num) {
      return sym() + ' ' + Math.round(num).toLocaleString();
    }

    function fmtPrice(pricePerGram, unit) {
      const v = unit === 'tola' ? pricePerGram * TOLA_IN_GRAMS : pricePerGram;
      const decimals = v < 10 ? 4 : v < 100 ? 2 : 0;
      return sym() + ' ' + v.toLocaleString(undefined, { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
    }

    function val(id) { return parseFloat(document.getElementById(id).value) || 0; }

    function setPrefix(ids, symbol) {
      ids.forEach(id => {
        const el = document.getElementById('prefix-' + id);
        if (el) el.textContent = symbol;
      });
    }

    // ‚îÄ‚îÄ Live price fetch ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function fetchLivePrices() {
      setStatus('loading');

      let metalsOk = false;
      let fxOk     = false;

      // Refresh UI immediately whenever either fetch resolves
      function refresh() {
        updateMetalPriceDisplay();
        updateNisabUI();
        calculate();
      }

      const metalsP = fetchMetalPrices().then(ok => { metalsOk = ok; refresh(); });
      const fxP     = fetchFXRates().then(ok  => { fxOk     = ok; refresh(); });

      // Wait for both, then set final status
      await Promise.allSettled([metalsP, fxP]);

      if (metalsOk && fxOk) {
        setStatus('live', new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }));
      } else if (metalsOk || fxOk) {
        setStatus('live', (metalsOk ? 'live metals' : 'ref metals') + ' ¬∑ ' + (fxOk ? 'live FX' : 'ref FX'));
      } else {
        setStatus('fallback');
      }
    }

    // CORS proxy helpers ‚Äî used because every direct metal API blocks GitHub Pages origin.
    // corsproxy.io: transparent, returns raw response.
    // allorigins.win: wraps response in { contents: "..." }.
    async function proxiedFetch(url) {
      // Try corsproxy.io first
      try {
        const r = await fetch('https://corsproxy.io/?' + encodeURIComponent(url));
        if (r.ok) return r;
      } catch (_) { /* fall through */ }
      // Fallback: allorigins.win raw (streams the raw body with CORS headers)
      const r = await fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent(url));
      if (!r.ok) throw new Error('proxy HTTP ' + r.status);
      return r;
    }

    // Fetch XAU / XAG spot prices in USD per troy oz.
    async function fetchMetalPrices() {
      // --- Source 1: goldprice.org via CORS proxy ---
      try {
        const res  = await proxiedFetch('https://data-asg.goldprice.org/dbXRates/USD');
        const data = await res.json();
        const item     = data.items?.[0];
        const goldOz   = item?.xauPrice;   // USD per troy oz
        const silverOz = item?.xagPrice;   // USD per troy oz
        if (goldOz > 0 && silverOz > 0) {
          goldPriceUSD   = goldOz   / TROY_OZ_TO_GRAMS;
          silverPriceUSD = silverOz / TROY_OZ_TO_GRAMS;
          dbg('goldprice.org (proxied)', true, `XAU $${goldOz.toFixed(2)}/oz ¬∑ XAG $${silverOz.toFixed(3)}/oz`);
          return true;
        } else {
          dbg('goldprice.org (proxied)', false, `xauPrice=${goldOz ?? 'null'}, xagPrice=${silverOz ?? 'null'} ¬∑ raw: ${JSON.stringify(data).slice(0,150)}`);
        }
      } catch (e) {
        dbg('goldprice.org (proxied)', false, e.message || 'fetch failed');
      }

      // --- Source 2: Yahoo Finance via CORS proxy ---
      try {
        const [resGold, resSilver] = await Promise.all([
          proxiedFetch('https://query1.finance.yahoo.com/v8/finance/chart/XAUUSD=X?interval=1d&range=1d'),
          proxiedFetch('https://query1.finance.yahoo.com/v8/finance/chart/XAGUSD=X?interval=1d&range=1d'),
        ]);
        const [dg, ds] = await Promise.all([resGold.json(), resSilver.json()]);
        const goldOz   = dg?.chart?.result?.[0]?.meta?.regularMarketPrice;
        const silverOz = ds?.chart?.result?.[0]?.meta?.regularMarketPrice;
        if (goldOz > 0 && silverOz > 0) {
          goldPriceUSD   = goldOz   / TROY_OZ_TO_GRAMS;
          silverPriceUSD = silverOz / TROY_OZ_TO_GRAMS;
          dbg('Yahoo Finance (proxied)', true, `XAU $${goldOz.toFixed(2)}/oz ¬∑ XAG $${silverOz.toFixed(3)}/oz`);
          return true;
        } else {
          dbg('Yahoo Finance (proxied)', false, `XAU=${goldOz ?? 'null'}, XAG=${silverOz ?? 'null'}`);
        }
      } catch (e) {
        dbg('Yahoo Finance (proxied)', false, e.message || 'fetch failed');
      }

      // open.er-api confirmed: XAU/XAG not in free tier ‚Äî skip
      dbg('open.er-api (metals)', false, 'XAU/XAG not included in free tier ‚Äî skipped');

      return false; // all sources failed ‚Äî caller will use FALLBACK_ constants
    }

    // Fetch fiat exchange rates vs USD (PKR, GBP, EUR, AED, SAR, CAD, AUD).
    async function fetchFXRates() {
      if (liveRates?.PKR) {
        dbg('FX rates', true, 'reused from metals fetch');
        return true;
      }

      try {
        const res  = await fetch('https://open.er-api.com/v6/latest/USD');
        const data = await res.json();
        if (data.result === 'success' && data.rates?.PKR > 0) {
          liveRates = data.rates;
          dbg('open.er-api (FX)', true,
            `PKR=${data.rates.PKR?.toFixed(2)}, GBP=${data.rates.GBP?.toFixed(4)}, EUR=${data.rates.EUR?.toFixed(4)}, AED=${data.rates.AED?.toFixed(4)}, SAR=${data.rates.SAR?.toFixed(4)}`);
          return true;
        } else {
          dbg('open.er-api (FX)', false, `result=${data.result}, PKR=${data.rates?.PKR ?? 'missing'}`);
        }
      } catch (e) {
        dbg('open.er-api (FX)', false, e.message || 'fetch failed');
      }

      try {
        const res  = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
        const data = await res.json();
        if (data.rates?.PKR > 0) {
          liveRates = data.rates;
          dbg('exchangerate-api v4 (FX)', true,
            `PKR=${data.rates.PKR?.toFixed(2)}, GBP=${data.rates.GBP?.toFixed(4)}, EUR=${data.rates.EUR?.toFixed(4)}`);
          return true;
        } else {
          dbg('exchangerate-api v4 (FX)', false, `PKR=${data.rates?.PKR ?? 'missing'}`);
        }
      } catch (e) {
        dbg('exchangerate-api v4 (FX)', false, e.message || 'fetch failed');
      }

      return false;
    }

    // ‚îÄ‚îÄ API debug log ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const _dbgRows = {};
    function dbg(key, ok, detail) {
      _dbgRows[key] = { ok, detail };
      const tbody = document.getElementById('api-debug-rows');
      if (!tbody) return;
      tbody.innerHTML = Object.entries(_dbgRows).map(([k, v]) =>
        `<tr>
          <td>${k}</td>
          <td class="${v.ok ? 'ok' : 'err'}">${v.ok ? '‚úì ok' : '‚úó fail'}</td>
          <td>${v.detail}</td>
        </tr>`
      ).join('');
    }

    function setStatus(type, detail) {
      const el = document.getElementById('price-status');
      const dot  = `<svg width="10" height="10" viewBox="0 0 10 10"><circle cx="5" cy="5" r="5" fill="currentColor"/></svg>`;
      const info = `<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>`;
      const icons = {
        loading:  `<svg class="spin" width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>`,
        live:     dot,
        partial:  info,
        fallback: info,
        error:    info,
      };
      const labels = {
        loading:  'Fetching live prices‚Ä¶',
        live:     `Live prices ¬∑ ${detail || ''}`,
        partial:  `Partial live ¬∑ ${detail || ''}`,
        fallback: 'Using reference prices',
        error:    'Price fetch failed',
      };
      el.className = `price-status price-status--${type}`;
      el.innerHTML = (icons[type] || '') + labels[type];
    }

    // ‚îÄ‚îÄ Metal price display ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function updateMetalPriceDisplay() {
      document.getElementById('gold-price-display').textContent   = fmtPrice(goldPerGramLocal(),   goldUnit);
      document.getElementById('silver-price-display').textContent = fmtPrice(silverPerGramLocal(), silverUnit);
      document.getElementById('gold-price-label').textContent   = `Live price / ${goldUnit}`;
      document.getElementById('silver-price-label').textContent = `Live price / ${silverUnit}`;
      document.getElementById('gold-unit-label').textContent   = goldUnit;
      document.getElementById('silver-unit-label').textContent = silverUnit;
    }

    // ‚îÄ‚îÄ Core calculation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function calculate() {
      const goldWeightGrams   = toGrams(val('gold-weight'),   goldUnit);
      const silverWeightGrams = toGrams(val('silver-weight'), silverUnit);

      const goldValue   = goldWeightGrams   * goldPerGramLocal();
      const silverValue = silverWeightGrams * silverPerGramLocal();

      const totalAssets =
        val('cash') + val('receivables') +
        goldValue + silverValue +
        val('stocks') + val('crypto') + val('other-investments') +
        val('business-inventory') + val('business-cash');

      const totalLiabilities = val('debts') + val('other-liabilities');
      const netWealth = Math.max(0, totalAssets - totalLiabilities);

      const nisabValue = nisabType === 'gold'
        ? GOLD_GRAMS_NISAB   * goldPerGramLocal()
        : SILVER_GRAMS_NISAB * silverPerGramLocal();

      const aboveNisab = netWealth >= nisabValue;
      const zakatDue   = aboveNisab ? netWealth * 0.025 : 0;

      document.getElementById('res-total-assets').textContent      = fmt(totalAssets);
      document.getElementById('res-total-liabilities').textContent = fmt(totalLiabilities);
      document.getElementById('res-net-wealth').textContent        = fmt(netWealth);
      document.getElementById('res-nisab').textContent             = fmt(nisabValue);
      document.getElementById('nisab-display').textContent         = fmt(nisabValue);

      const statusEl = document.getElementById('nisab-status');
      statusEl.style.display = 'block';
      if (aboveNisab) {
        statusEl.className   = 'result-nisab-status above';
        statusEl.textContent = '‚úì Above the Nisab threshold ‚Äî Zakat is due.';
      } else {
        statusEl.className   = 'result-nisab-status below';
        statusEl.textContent = '‚óå Below the Nisab threshold ‚Äî Zakat is not due.';
      }

      const amountEl = document.getElementById('res-zakat-amount');
      const noteEl   = document.getElementById('res-zakat-note');
      if (aboveNisab) {
        amountEl.textContent = fmt(zakatDue);
        amountEl.style.color = 'var(--green)';
        noteEl.textContent   = '2.5% √ó ' + fmt(netWealth) + ' net wealth';
      } else {
        amountEl.textContent = fmt(0);
        amountEl.style.color = 'var(--muted)';
        noteEl.textContent   = 'Wealth is below Nisab ‚Äî no Zakat required';
      }
    }

    // ‚îÄ‚îÄ Currency UI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function updateCurrencyUI() {
      const meta = currencyMeta[currencyKey];
      const monetary = [
        'cash','receivables','stocks','crypto','other-investments',
        'business-inventory','business-cash','debts','other-liabilities'
      ];
      setPrefix(monetary, meta.symbol);

      // Set default units for this currency
      goldUnit   = meta.defaultUnit;
      silverUnit = meta.defaultUnit;

      // Sync unit toggle buttons
      document.querySelectorAll('.unit-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.unit === meta.defaultUnit);
      });

      updateMetalPriceDisplay();
    }

    // ‚îÄ‚îÄ Nisab info text ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function updateNisabUI() {
      const infoEl = document.getElementById('nisab-info');
      if (nisabType === 'gold') {
        infoEl.innerHTML = `Nisab (Gold): <strong id="nisab-display">‚Äî</strong> &nbsp;¬∑&nbsp; 87.48g = 7.5 tola of gold`;
      } else {
        infoEl.innerHTML = `Nisab (Silver): <strong id="nisab-display">‚Äî</strong> &nbsp;¬∑&nbsp; 612.36g = 52.5 tola of silver`;
      }
    }

    // ‚îÄ‚îÄ Event listeners ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.getElementById('currency-select').addEventListener('change', function () {
      currencyKey = this.value;
      updateCurrencyUI();
      updateNisabUI();
      calculate();
    });

    document.querySelectorAll('.nisab-tab').forEach(btn => {
      btn.addEventListener('click', function () {
        document.querySelectorAll('.nisab-tab').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        nisabType = this.dataset.type;
        updateNisabUI();
        calculate();
      });
    });

    document.querySelectorAll('.unit-btn').forEach(btn => {
      btn.addEventListener('click', function () {
        const metal = this.dataset.metal; // 'gold' | 'silver'
        const unit  = this.dataset.unit;  // 'gram' | 'tola'

        // Update active state within this metal's toggle
        document.querySelectorAll(`.unit-btn[data-metal="${metal}"]`)
          .forEach(b => b.classList.toggle('active', b === this));

        if (metal === 'gold')   goldUnit   = unit;
        if (metal === 'silver') silverUnit = unit;

        updateMetalPriceDisplay();
        calculate();
      });
    });

    document.querySelectorAll('input[type="number"]').forEach(input => {
      input.addEventListener('input', calculate);
    });

    // ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.getElementById('year').textContent = new Date().getFullYear();
    updateCurrencyUI();
    updateNisabUI();
    calculate();
    fetchLivePrices();
  </script>

</body>
</html>
